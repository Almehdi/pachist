#!/bin/bash

## Coloring
col_1="black"
col_2="white"
col_3="blue"

## What type of packages to list
fltr_1="starting"
fltr_2="upgraded"
fltr_3="downgraded"
fltr_4="\[PACMAN\].*installed"
#fltr_5="BAJS"

## The command that makes it happen.
filter() {
	awk -F' ' /\($fltr_1\|$fltr_2\|$fltr_3\|$fltr_4\|$fltr_5\)/'{print $1,$2,substr($0, index($0,$4))}' /var/log/pacman.log
}

## finish with some colour and formatting.
formatting() {
	filter | sed "s/.*full.*//" | colout '(\[.*\]) (.*) (\(.*\))' $col_1,$col_2,$col_3
}

help() {
	echo 'pachist version 0.0.2'
	echo ''
	echo 'usage: pachist [options] [number of lines]'
	echo ''
	echo 'options:'
	echo '	-v		Show verbose messages'
	echo '	-h		Show this help'
	echo '	<number>	Rows of lines to show'
	echo ''
	exit
}

## Add the verbose prefix to show messages.
[[ $* =~ "-h" ]] && help

## Add the verbose prefix to show messages.
[[ $* =~ "-v" ]] && fltr_5="ALPM-SCRIPTLET" || fltr_5="BAJS"

## Print full log or just a couple of lines.
[[ ! $* = "^[-0-9]+$" ]] && formatting | tail -n$(echo $* | grep -o "[0-9]*") || formatting

#case $* in
#	-h) help
#	;;
#	-v)
#		fltr_5="ALPM-SCRIPTLET"
#		formatting
#	;;
#	*[0-9]*) formatting | tail -n$1
#esac
